rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // Match any file within a user-specific folder under "summaries"
    match /summaries/{userId}/{allPaths=**} {
      
      // Allow writing (uploads) only if the user is authenticated and their ID matches the folder name.
      // This ensures users can only write to their own directory.
      allow write: if request.auth != null && request.auth.uid == userId;

      // Allow public read access for all files inside the summaries folders.
      // This is necessary for the shareable links to work for anyone.
      allow read;
    }
  }
}
